<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Amigo Secreto</title>
  <link rel="icon" type="image/png" href="https://res.cloudinary.com/djhgmmdjx/image/upload/v1762920149/cornenavidad_lxtqh3.webp">
  <link rel="stylesheet" href="css/style.css">

  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
</head>
<body>

  <div id="auth-modal-overlay">
    <div id="auth-modal-content">
      <h1>Bienvenido</h1>
      <div id="login-form">
        <h3>Iniciar SesiÃ³n</h3>
        <input type="email" id="login-email" placeholder="Correo" autocomplete="email" required>
        <input type="password" id="login-password" placeholder="ContraseÃ±a" autocomplete="current-password" required>
        <button id="login-btn">Entrar</button>
        <p>Â¿No tienes cuenta? <a href="#" id="show-register">RegÃ­strate</a></p>
      </div>
      <div id="register-form" style="display:none;">
        <h3>Crear Cuenta</h3>
        <input type="text" id="register-name" placeholder="Tu Nombre" autocomplete="name" required>
        <input type="email" id="register-email" placeholder="Correo" autocomplete="email" required>
        <input type="password" id="register-password" placeholder="ContraseÃ±a" autocomplete="new-password" required>
        <button id="register-btn">Registrarme</button>
        <p>Â¿Ya tienes cuenta? <a href="#" id="show-login">Inicia sesiÃ³n</a></p>
      </div>
    </div>
  </div>

  <div id="app-wrapper" style="display:none;">
    
    <nav id="top-nav">
      <ul>
        <li><a href="#" class="nav-btn active" data-target="inicio-section">Inicio</a></li>
        <li><a href="#" class="nav-btn" data-target="sorteo-section">Sorteo</a></li>
        <li><a href="#" class="nav-btn" data-target="historial-section">Amigo Secreto 2024</a></li>
        <li><a href="#" class="nav-btn" data-target="deseos-section">Listas de deseados</a></li>
        <li><a href="#" class="nav-btn" data-target="perfil-section">Mi Perfil</a></li> 
        <li><a href="https://store.steampowered.com/specials" target="_blank" rel="noopener noreferrer" id="steam-nav-link">Ofertas Steam</a></li>

        <li class="nav-user-group">
          <span id="nav-username"></span>
          <a href="#" id="logout-btn" style="background-color:#e11d48;">Salir</a>
        </li>
      </ul>
    </nav>

    <div id="content-container">
      
      <section id="inicio-section" class="content-section">
        
        <div id="secret-friend-container">
          </div>

        <div class="instructions-card">
          <h3>Â¿CÃ³mo funciona el Amigo Secreto?</h3>
          <p>La idea de este juego es simple: cada participante le hace un regalo a otro participante, Â¡pero nadie sabe quiÃ©n le regala a quiÃ©n hasta el final!</p>
          <ul>
            <li><strong>Sorteo:</strong> La aplicaciÃ³n asigna a cada persona un "Amigo Secreto" de forma aleatoria y secreta.</li>
            <li><strong>Agregarse en Steam:</strong> Agregarse en steam antes del dÃ­a de la entrega es lo ideal para evitar la espera de 1 dÃ­a que tiene steam para regalarse algo. (Pueden dejar su cÃ³digo en la secciÃ³n <a href="#" class="nav-btn-inline" data-target="perfil-section">Mi Perfil</a>).</li>
            <li><strong>Lista de Deseos:</strong> Revisa la <a href="#" class="nav-btn-inline" data-target="deseos-section">Lista de deseados</a> para ver quÃ© quiere tu amigo.</li>
            <li><strong>Regalo:</strong> Compra el regalo cumpliendo el presupuesto mÃ­nimo; No hace falta regirse por la lista de deseados, puede ser lo que quieras.</li>
            <li><strong>Entrega:</strong> El dÃ­a acordado para entregarse los regalos, ojalÃ¡ estar todos en discord.</li>
          </ul>
          <p class="event-date">
            La entrega de regalos serÃ¡ el: <strong>?? de diciembre de 2025</strong>
          </p>
        </div>

      </section>
      
      <section id="sorteo-section" class="content-section hidden">
        </section>
      
      <section id="historial-section" class="content-section hidden">
        <div id="historial-btn-container" style="display: flex; justify-content: center; gap: 20px; margin-top: 10px; flex-wrap: wrap;"></div>
        <div id="historial-contenido" class="historial-container" style="display: none; margin-top: 2rem;"></div>
      </section>

      <section id="perfil-section" class="content-section hidden">
        <div class="my-wishlist-card">
          <h3>Configura tu Perfil Steam</h3>
          
          <div style="background-color: #f0fdf4; border-left: 4px solid var(--btn-green); padding: 15px; margin-bottom: 20px; color: #14532d;">
            <p style="margin:0;"><strong>ğŸ’¡ Importante:</strong> Agregarse en Steam antes del dÃ­a de la entrega es ideal para evitar la restricciÃ³n de espera de 3 dÃ­as (o 1 aÃ±o si no tienen autenticador mÃ³vil) que tiene Steam para enviar regalos.</p>
          </div>

          <div class="form-group">
             <label style="display:block; margin-bottom:5px; font-weight:600; color:var(--nav-bg);">Tu CÃ³digo de Amigo:</label>
             <input type="text" id="my-steam-friend-code" placeholder="Ej: 12345678">
             <p style="font-size: 0.85rem; color: #666; margin-top: 5px;">Copia esto desde <a href="https://steamcommunity.com/my/friends/add" target="_blank" rel="noopener noreferrer" style="color: var(--btn-green); text-decoration: underline; font-weight: bold;"> aqui</a> o desde la opciÃ³n "AÃ±adir a un amigo" en Steam para que los demÃ¡s te agreguen fÃ¡cilmente.</p>
          </div>

          <hr class="card-divider">

          <p>Pega la URL de tu <a href="https://store.steampowered.com/wishlist/" target="_blank" rel="noopener noreferrer" class="nav-btn-inline">Lista de Deseados de Steam</a> para que tu amigo secreto sepa quÃ© regalarte.</p>
          
          <div class="form-group">
            <input type="text" id="my-wishlist-url" placeholder="https://store.steampowered.com/wishlist/id/tu_usuario/">
          </div>

          <button id="save-profile-btn" class="btn-primary" style="margin-top: 10px;">Guardar Mi Perfil</button>
        </div>
      </section>

      <section id="deseos-section" class="content-section hidden">
        <div class="sorteo-list-container">
          <h2 style="text-align: center;" id="wishlist-sorteo-title">ğŸ Tus Sorteos ğŸ</h2>
          <div class="wishlist-container" id="wishlist-container-dynamic">
             </div>
        </div>
      </section>

    </div>
  </div>

  <div class="snow"><canvas id="snowfall"></canvas></div>
  
  <div id="audio-controls" aria-label="Controles de audio">
    <button id="play-pause-btn" aria-label="Reproducir mÃºsica"><svg viewBox="0 0 24 24"><path d="M6 4 L20 12 L6 20 Z" /></svg></button>
    <div id="volume-container"><input type="range" id="volume-slider" min="0" max="100" value="2" aria-label="Control de volumen" /></div>
  </div>
  <audio id="audio-player" src="https://fortnite.gg/img/items/3340/audio.mp3?1" loop></audio>
  
  <div id="app-modal-overlay" class="modal-overlay hidden">
    <div class="app-modal-content">
      <h3 id="app-modal-title"></h3>
      <p id="app-modal-message"></p>
      <div id="app-modal-prompt-container" class="hidden"><input type="text" id="app-modal-prompt-input"></div>
      <div class="modal-actions">
        <button id="app-modal-cancel-btn" class="btn-secondary" style="background-color: #6b7280;">Cancelar</button>
        <button id="app-modal-confirm-btn" class="btn-primary">Aceptar</button>
      </div>
    </div>
  </div>

  <script src="script.js"></script>
</body>
</html>
